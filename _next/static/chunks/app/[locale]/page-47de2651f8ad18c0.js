(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[61],{91384:function(e,l,n){Promise.resolve().then(n.bind(n,34327)),Promise.resolve().then(n.bind(n,21953))},21953:function(e,l,n){"use strict";n.d(l,{default:function(){return g}});var o=n(57437),t=n(2265),i=n(63395),a=n(93999),s=n(77744),r=n(79593),u=n(93996),d=n(5892),c=n(94648),m=e=>{let l=(0,r.dD)(),n=(0,s.YP)(),i=(e,l,o)=>{var t,i;let a=null,s=Math.pow(2,(null==n?void 0:n.getZoom())||15),r=null==n?void 0:null===(t=n.getProjection())||void 0===t?void 0:t.fromLatLngToPoint(e),u=new google.maps.Point(l/s,o/s);return r&&(a=null==n?void 0:null===(i=n.getProjection())||void 0===i?void 0:i.fromPointToLatLng(new google.maps.Point(r.x-u.x,r.y+u.y))),a||null},a=t.useCallback(()=>{e.onPress&&e.onPress(e);let o=l(),t=i(new google.maps.LatLng(e.lat,e.lon),o?0:-155.5,o?(window.innerHeight-64)/1.5/2:0);t&&(null==n||n.panTo(t))},[]);return e.facility===u._.BIKE_STATION?(0,o.jsx)(d.Z,{...e,onPress:a}):(0,o.jsx)(c.Z,{...e,onPress:a})},f=n(63874),g=()=>{let e=t.useRef(),{queryParameters:l,setQueryParameters:n}=(0,f.q)(),u=(0,r.YZ)(),{stations:d,waterFountains:c,lastUpdated:g,isLoading:v,refetch:C}=(0,r.Rx)(),[p,b]=t.useState(void 0),[P,k]=(0,r.$r)({timeout:3500},()=>{},e=>{a.Am.error(null==e?void 0:e.message)}),h=t.useMemo(()=>({lat:parseFloat("43.7292717"),lng:parseFloat("-79.6082231")}),[]),x=t.useMemo(()=>[...c||[],...d||[]],[c,d]),_=t.useMemo(()=>P.latitude&&P.longitude?{lat:P.latitude,lng:P.longitude}:void 0,[P.timestamp]),w=t.useCallback(e=>{e.markers.map(e=>{e.setVisible(!1)})},[]),y=t.useCallback(e=>{e.clusters.map(e=>{let n=e.getMarkers();if(1===n.length){let e=n[0].getPosition();n.forEach(n=>{var o,t,i;if(n&&(null===(o=n.getPosition())||void 0===o?void 0:o.lat())==(null==e?void 0:e.lat())&&(null===(t=n.getPosition())||void 0===t?void 0:t.lng())==(null==e?void 0:e.lng())){let e=null===(i=x.find(e=>e.name===n.getTitle()))||void 0===i?void 0:i.facility;e&&(null==l?void 0:l.facility.includes(e))&&n.setVisible(!0)}})}})},[x,l]);return t.useEffect(()=>{k()},[]),t.useEffect(()=>{u||C()},[l]),t.useEffect(()=>{var l;null===(l=e.current)||void 0===l||l.repaint()},[x]),(0,o.jsxs)(i.b6,{onClick:()=>b(void 0),mapContainerClassName:"w-full h-full relative",zoom:15,defaultCenter:h,center:_,options:{backControl:!0,backControlOptions:{onClick:k,isLoading:(null==P?void 0:P.loading)||void 0},fullscreenControl:!1,streetViewControl:!1,zoomControl:!1,mapId:"ef34fc3265e9becb",mapTypeControl:!1,clickableIcons:!1},children:[(0,o.jsx)(i.lD,{className:"hidden md:flex",isLoading:v,lastUpdated:g,queryParameters:l,onSubmit:n}),(0,o.jsx)(s.Cg,{gridSize:50,minimumClusterSize:20,clusterClass:"map-cluster [&>*]:!text-[#fff] [&>*]:!font-roboto",onLoad:l=>e.current=l,averageCenter:!0,enableRetinaIcons:!1,onClusteringBegin:w,onClusteringEnd:y,onUnmount:e=>e.clearMarkers(),children:e=>(0,o.jsx)(o.Fragment,{children:x.map(l=>(0,t.createElement)(m,{...l,clusterer:e,key:l.station_id,onPress:b,active:l.facility===(null==p?void 0:p.facility)&&l.station_id===(null==p?void 0:p.station_id)}))})}),(0,o.jsx)(i.zC,{geolocation:P,visible:void 0!==p,marker:p,onCancel:()=>b(void 0)})]})}}},function(e){e.O(0,[910,990,373,970,39,15,49,827,971,23,744],function(){return e(e.s=91384)}),_N_E=e.O()}]);