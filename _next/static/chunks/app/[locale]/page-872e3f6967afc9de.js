(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[61],{91384:function(e,o,l){Promise.resolve().then(l.bind(l,34327)),Promise.resolve().then(l.bind(l,21953))},21953:function(e,o,l){"use strict";l.d(o,{default:function(){return g}});var n=l(57437),t=l(2265),i=l(63395),a=l(93999),s=l(77744),r=l(79593),u=l(93996),d=l(5892),c=l(94648),f=e=>{let o=(0,r.dD)(),l=(0,s.YP)(),i=(e,o,n)=>{var t,i;let a=null,s=Math.pow(2,(null==l?void 0:l.getZoom())||15),r=null==l?void 0:null===(t=l.getProjection())||void 0===t?void 0:t.fromLatLngToPoint(e),u=new google.maps.Point(o/s,n/s);return r&&(a=null==l?void 0:null===(i=l.getProjection())||void 0===i?void 0:i.fromPointToLatLng(new google.maps.Point(r.x-u.x,r.y+u.y))),a||null},a=t.useCallback(()=>{e.onPress&&e.onPress(e);let n=o(),t=i(new google.maps.LatLng(e.lat,e.lon),n?0:-155.5,n?(window.innerHeight-64)/1.5/2:0);t&&(null==l||l.panTo(t))},[]);return e.facility===u._.BIKE_STATION?(0,n.jsx)(d.Z,{...e,onPress:a}):(0,n.jsx)(c.Z,{...e,onPress:a})},v=l(63874),g=()=>{let e=t.useRef(),{queryParameters:o,setQueryParameters:l}=(0,v.q)(),u=(0,r.YZ)(),{stations:d,waterFountains:c,lastUpdated:g,isLoading:m,refetch:p}=(0,r.Rx)(),[C,b]=t.useState(void 0),[P,k]=(0,r.$r)({timeout:3500},()=>{},e=>{a.Am.error(null==e?void 0:e.message)}),h=t.useMemo(()=>({lat:parseFloat("43.7292717"),lng:parseFloat("-79.6082231")}),[]),x=t.useMemo(()=>[...c||[],...d||[]],[c,d]),_=t.useMemo(()=>P.latitude&&P.longitude?{lat:P.latitude,lng:P.longitude}:void 0,[P.timestamp]),w=t.useCallback(e=>{e.markers.map(e=>{e.setVisible(!1)})},[]),y=t.useCallback(e=>{e.clusters.map(e=>{let l=e.getMarkers();if(1===l.length){let e=l[0].getPosition();l.forEach(l=>{var n,t,i;if(l&&(null===(n=l.getPosition())||void 0===n?void 0:n.lat())==(null==e?void 0:e.lat())&&(null===(t=l.getPosition())||void 0===t?void 0:t.lng())==(null==e?void 0:e.lng())){let e=null===(i=x.find(e=>e.name===l.getTitle()))||void 0===i?void 0:i.facility;e&&(null==o?void 0:o.facility.includes(e))&&l.setVisible(!0)}})}})},[x,o]);return t.useEffect(()=>{k()},[]),t.useEffect(()=>{u||p()},[o]),t.useEffect(()=>{var o;null===(o=e.current)||void 0===o||o.repaint()},[x]),(0,n.jsxs)(i.b6,{onClick:()=>b(void 0),mapContainerClassName:"w-full h-full relative",zoom:15,defaultCenter:h,center:_,options:{backControl:!0,backControlOptions:{onClick:k,isLoading:(null==P?void 0:P.loading)||void 0},fullscreenControl:!1,streetViewControl:!1,zoomControl:!1,mapId:"ef34fc3265e9becb",mapTypeControl:!1,clickableIcons:!1},children:[(0,n.jsx)(i.lD,{className:"hidden md:flex",isLoading:m,lastUpdated:g,queryParameters:o,onSubmit:l}),(0,n.jsx)(s.Cg,{clusterClass:"map-cluster [&>*]:!text-[#fff] [&>*]:!font-roboto",onLoad:o=>e.current=o,averageCenter:!0,enableRetinaIcons:!1,onClusteringBegin:w,onClusteringEnd:y,onUnmount:e=>e.clearMarkers(),children:e=>(0,n.jsx)(n.Fragment,{children:x.map(o=>(0,t.createElement)(f,{...o,clusterer:e,key:o.station_id,onPress:b,active:o.facility===(null==C?void 0:C.facility)&&o.station_id===(null==C?void 0:C.station_id)}))})}),(0,n.jsx)(i.zC,{geolocation:P,visible:void 0!==C,marker:C,onCancel:()=>b(void 0)})]})}}},function(e){e.O(0,[910,990,373,970,39,15,49,827,971,23,744],function(){return e(e.s=91384)}),_N_E=e.O()}]);